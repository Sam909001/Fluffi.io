<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>$FLUFFI Presale & Staking</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    body {
      background: linear-gradient(to bottom, #fff0f5, #fff9e6);
    }
    .dark {
      background: #111827;
      color: white;
    }
    .dark .bg-white {
      background-color: #1f2937 !important;
    }
  </style>
</head>
<body class="text-gray-800 dark:text-white">
  <header class="bg-white dark:bg-gray-900 shadow sticky top-0 z-10 p-4">
    <div class="flex justify-between items-center max-w-6xl mx-auto">
      <div class="flex items-center gap-3">
        <img src="fluffi.jpg" alt="$FLUFFI Logo" class="w-10 h-10">
        <h1 class="text-xl font-bold">$FLUFFI</h1>
      </div>
      <nav class="flex items-center gap-4">
        <a href="#presale" class="hover:underline">Presale</a>
        <a href="#staking" class="hover:underline">Staking</a>
        <button id="darkModeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700">ðŸŒ™</button>
        <button id="walletButton" class="bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded">
          Connect Wallet
        </button>
      </nav>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-6">
    <section id="presale" class="bg-white dark:bg-gray-800 rounded shadow p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Presale is Live!</h2>
      <div class="space-y-4">
        <p id="stageInfo">Stage: 1 / 15</p>
        <p id="priceInfo">Price: $0.000100</p>
        <div class="w-full bg-gray-200 rounded-full h-4">
          <div id="progressBar" class="bg-green-500 h-4 rounded-full" style="width: 10%"></div>
        </div>
        <p id="countdown" class="font-mono">Ends in: 29d 23h 59m 59s</p>
        <input type="number" id="amountInput" placeholder="Amount in USD" class="w-full p-3 border rounded">
        <input type="text" id="refInput" placeholder="Referral wallet (optional)" class="w-full p-3 border rounded">
        <button id="buyButton" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded">
          Buy Now
        </button>
      </div>
    </section>

    <section id="staking" class="bg-white dark:bg-gray-800 rounded shadow p-6 mb-6">
      <h2 class="text-2xl font-bold mb-4">Stake Your $FLUFFI</h2>
      <div class="space-y-4">
        <p>APY: <strong>90%</strong> | Ends at Listing Date</p>
        <input type="number" id="stakeInput" placeholder="Amount to stake" class="w-full p-3 border rounded">
        <button id="stakeButton" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 px-4 rounded">
          Stake
        </button>
      </div>
    </section>
  </main>

  <script>
    // State management
    const state = {
      walletConnected: false,
      darkMode: localStorage.getItem('darkMode') === 'true',
      stage: 1,
      price: 0.0001
    };

    // DOM elements
    const elements = {
      darkModeToggle: document.getElementById('darkModeToggle'),
      walletButton: document.getElementById('walletButton'),
      buyButton: document.getElementById('buyButton'),
      stakeButton: document.getElementById('stakeButton'),
      amountInput: document.getElementById('amountInput'),
      stakeInput: document.getElementById('stakeInput'),
      stageInfo: document.getElementById('stageInfo'),
      priceInfo: document.getElementById('priceInfo'),
      progressBar: document.getElementById('progressBar'),
      countdown: document.getElementById('countdown')
    };

    // Initialize the app
    function init() {
      setupEventListeners();
      applyDarkMode();
      startCountdown();
      updateStageInfo();
    }

    // Set up all event listeners
    function setupEventListeners() {
      elements.darkModeToggle.addEventListener('click', toggleDarkMode);
      elements.walletButton.addEventListener('click', handleWalletConnection);
      elements.buyButton.addEventListener('click', handleBuy);
      elements.stakeButton.addEventListener('click', handleStake);
    }

    // Dark mode functionality
    function toggleDarkMode() {
      state.darkMode = !state.darkMode;
      localStorage.setItem('darkMode', state.darkMode);
      applyDarkMode();
    }

    function applyDarkMode() {
      if (state.darkMode) {
        document.documentElement.classList.add('dark');
        elements.darkModeToggle.textContent = 'â˜€ï¸';
      } else {
        document.documentElement.classList.remove('dark');
        elements.darkModeToggle.textContent = 'ðŸŒ™';
      }
    }

    // Wallet connection
    async function handleWalletConnection() {
      if (state.walletConnected) return;
      
      if (typeof window.ethereum === 'undefined') {
        alert('Please install MetaMask to connect your wallet');
        return;
      }

      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        if (accounts.length > 0) {
          state.walletConnected = true;
          updateWalletButton(accounts[0]);
        }
      } catch (error) {
        console.error('Wallet connection error:', error);
        alert('Failed to connect wallet');
      }
    }

    function updateWalletButton(address) {
      elements.walletButton.textContent = `${address.substring(0, 6)}...${address.substring(38)}`;
      elements.walletButton.classList.remove('bg-green-500', 'hover:bg-green-600');
      elements.walletButton.classList.add('bg-green-700', 'cursor-default');
    }

    // Buy functionality
    function handleBuy() {
      if (!state.walletConnected) {
        alert('Please connect your wallet first');
        return;
      }

      const amount = parseFloat(elements.amountInput.value);
      if (isNaN(amount) {
        alert('Please enter a valid amount');
        return;
      }

      elements.buyButton.disabled = true;
      elements.buyButton.textContent = 'Processing...';

      // Simulate transaction
      setTimeout(() => {
        alert(`Successfully purchased $${amount} worth of FLUFFI`);
        elements.buyButton.disabled = false;
        elements.buyButton.textContent = 'Buy Now';
      }, 1500);
    }

    // Stake functionality
    function handleStake() {
      if (!state.walletConnected) {
        alert('Please connect your wallet first');
        return;
      }

      const amount = parseFloat(elements.stakeInput.value);
      if (isNaN(amount)) {
        alert('Please enter a valid amount');
        return;
      }

      elements.stakeButton.disabled = true;
      elements.stakeButton.textContent = 'Processing...';

      // Simulate transaction
      setTimeout(() => {
        alert(`Successfully staked ${amount} FLUFFI tokens`);
        elements.stakeButton.disabled = false;
        elements.stakeButton.textContent = 'Stake';
      }, 1500);
    }

    // Stage and countdown functionality
    function updateStageInfo() {
      elements.stageInfo.textContent = `Stage: ${state.stage} / 15`;
      elements.priceInfo.textContent = `Price: $${state.price.toFixed(6)}`;
      elements.progressBar.style.width = `${(state.stage / 15) * 100}%`;
    }

    function startCountdown() {
      const endDate = new Date();
      endDate.setDate(endDate.getDate() + 30);
      
      function update() {
        const now = new Date();
        const diff = endDate - now;
        
        if (diff <= 0) {
          elements.countdown.textContent = "Presale ended";
          return;
        }
        
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        
        elements.countdown.textContent = `Ends in: ${days}d ${hours}h ${minutes}m ${seconds}s`;
      }
      
      update();
      setInterval(update, 1000);
    }

    // Initialize the app when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
